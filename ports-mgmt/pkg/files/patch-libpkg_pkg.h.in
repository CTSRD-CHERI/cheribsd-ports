--- libpkg/pkg.h.in.orig	2021-11-12 08:57:25 UTC
+++ libpkg/pkg.h.in
@@ -62,9 +62,14 @@ extern "C" {
 
 #define PKG_PORTVERSION "@VERSION@"
 
-/* The OS major version at the time of compilation */
-#ifdef __FreeBSD__
-#define OSMAJOR	__FreeBSD__
+/*
+ * The OS major version at the time of compilation.
+ *
+ * CheriBSD doesn't have the notion of the major OS version, i.e. two ABI
+ * versions are always treated as possibly incompatible.
+ */
+#ifdef __CheriBSD_version
+#define OSMAJOR	__CheriBSD_version
 #endif
 
 /* Not supported under DragonFly */
